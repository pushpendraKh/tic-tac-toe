{"ast":null,"code":"import _asyncToGenerator from \"/Users/pushpendra.khandelwal/Desktop/web3_training/tic-tac-toe/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/services/contract.service\";\nimport * as i3 from \"@angular/common\";\nconst _c0 = function (a0) {\n  return {\n    \"text-teal\": a0\n  };\n};\nfunction GamePageComponent_div_4_h1_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h1\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(2, _c0, ctx_r2.activePlayer == \"O\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.activePlayer, \"'S TURN \");\n  }\n}\nconst _c1 = function (a0) {\n  return {\n    noClick: a0\n  };\n};\nfunction GamePageComponent_div_4_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 14)(1, \"div\", 15);\n    i0.ɵɵlistener(\"click\", function GamePageComponent_div_4_div_5_Template_div_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const square_r4 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r5.squareClicked(square_r4));\n    });\n    i0.ɵɵelementStart(2, \"p\", 16);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const square_r4 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(2, _c1, ctx_r3.winner));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(square_r4.state);\n  }\n}\nfunction GamePageComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4)(1, \"div\", 5)(2, \"div\");\n    i0.ɵɵtemplate(3, GamePageComponent_div_4_h1_3_Template, 2, 4, \"h1\", 6);\n    i0.ɵɵelementStart(4, \"div\", 7);\n    i0.ɵɵtemplate(5, GamePageComponent_div_4_div_5_Template, 4, 4, \"div\", 8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 9)(7, \"h2\");\n    i0.ɵɵtext(8, \"Timer\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 10);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(11, \"div\", 11)(12, \"h3\");\n    i0.ɵɵtext(13, \"Details\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"div\", 12)(15, \"ul\")(16, \"li\");\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"li\");\n    i0.ɵɵtext(19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"li\");\n    i0.ɵɵtext(21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"li\");\n    i0.ɵɵtext(23);\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.isGameRunning);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.board);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.display, \" \");\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate1(\"WinnerName: \", ctx_r0.winnerName, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"WinnerName: \", ctx_r0.winnerName, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"WinnerName: \", ctx_r0.winnerName, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"WinnerName: \", ctx_r0.winnerName, \"\");\n  }\n}\nfunction GamePageComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" \\\"Game is not running\\\" \");\n    i0.ɵɵelementEnd();\n  }\n}\nexport class GamePageComponent {\n  constructor(route, contractService) {\n    var _this = this;\n    this.route = route;\n    this.contractService = contractService;\n    this.isGameRunning = false;\n    this.winner = false;\n    this.activePlayer = \"X\";\n    this.isGameOver = false;\n    this.turnCount = 0;\n    this.isValidGame = false;\n    this.gameId = -1;\n    this.checkGameState = /*#__PURE__*/_asyncToGenerator(function* () {\n      _this.isGameRunning = yield _this.contractService.isGameRunning(_this.gameId);\n    });\n    console.log(\"constructor\");\n    this.gameId = route.snapshot.params['id'];\n    this.checkGameState();\n  }\n  ngOnInit() {\n    this.contractService.gameStartedObject$.subscribe(data => {\n      console.log(\"gameStartedObject\", data);\n      this.room = data;\n    });\n    // this.contractService.moveIndex$.subscribe((data) => {\n    //   console.log(\"gameStartedObject\",data);\n    //   this.room = data;\n    // });\n    this.newGame();\n    this.timer(2);\n  }\n  newGame() {\n    this.board = this.createBoard();\n  }\n  createBoard() {\n    let board = [];\n    console.log(this.room, \"room\");\n    for (let i = 0; i < this.room.board.length; i++) {\n      board.push({\n        id: i,\n        state: this.room[i] == 1 ? \"X\" : \"0\"\n      });\n    }\n    return board;\n  }\n  squareClicked(index) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      if (_this2.isGameRunning) {\n        try {\n          yield _this2.contractService.move(_this2.gameId, index);\n          _this2.contractService.loader$.next(false);\n        } catch (e) {\n          alert(\"Error while playing move\");\n        }\n      }\n    })();\n  }\n  // changePlayer(square: any) {\n  //   if (this.isGameRunning && square.state === null) {\n  //     this.contractService.move(this.gameId, square.id).then((resp) => {\n  //       this.contractService.loader$.next(false);\n  //       // this.winnerName = resp;\n  //       this.changePlayerTurn(square);\n  //     });\n  //     square.state = this.activePlayer;\n  //   }\n  // }\n  // private changePlayerTurn(squareClicked: any) {\n  //   this.updateBoard(squareClicked);\n  //   if (!this.isGameOver)\n  //     this.activePlayer = this.activePlayer === \"X\" ? \"O\" : \"X\";\n  //   this.turnCount++;\n  //   this.isGameOver = this.isGameOver ? true : false;\n  // }\n  // updateBoard(squareClicked: any) {\n  //   this.board[squareClicked.id].state = squareClicked.state;\n  //   if (this.isWinner) {\n  //     this.winner = true;\n  //     this.isGameRunning = false;\n  //     this.isGameOver = true;\n  //   }\n  // }\n  // get isWinner(): boolean {\n  //   return this.checkDiag() ||\n  //     this.checkRows(this.board, \"row\") ||\n  //     this.checkRows(this.board, \"col\")\n  //     ? true\n  //     : false;\n  // }\n  // checkDiag() {\n  //   const timesRun = 2,\n  //     midSquare = this.board[4].state;\n  //   for (let i = 0; i <= timesRun; i += 2) {\n  //     let upperCorner = this.board[i].state,\n  //       lowerCorner = this.board[8 - i].state;\n  //     if (midSquare && upperCorner && lowerCorner) {\n  //       if (midSquare === upperCorner && upperCorner === lowerCorner)\n  //         return true;\n  //     }\n  //   }\n  //   return false;\n  // }\n  // checkRows(board: any, mode: any): boolean {\n  //   const ROW = mode === \"row\" ? true : false,\n  //     DIST = ROW ? 1 : 3,\n  //     INC = ROW ? 3 : 1,\n  //     NUMTIMES = ROW ? 7 : 3;\n  //   for (let i = 0; i < NUMTIMES; i += INC) {\n  //     let firstSquare = board[i].state,\n  //       secondSquare = board[i + DIST].state,\n  //       thirdSquare = board[i + DIST * 2].state;\n  //     if (firstSquare && secondSquare && thirdSquare) {\n  //       if (firstSquare === secondSquare && secondSquare === thirdSquare)\n  //         return true;\n  //     }\n  //   }\n  //   return false;\n  // }\n  timer(minute) {\n    // let minute = 1;\n    let seconds = minute * 60;\n    let textSec = \"0\";\n    let statSec = 60;\n    const prefix = minute < 10 ? \"0\" : \"\";\n    const timer = setInterval(() => {\n      seconds--;\n      if (statSec != 0) statSec--;else statSec = 59;\n      if (statSec < 10) {\n        textSec = \"0\" + statSec;\n      } else textSec = statSec;\n      this.display = `${prefix}${Math.floor(seconds / 60)}:${textSec}`;\n      if (seconds == 0) {\n        this.display = \"Time Up\";\n        clearInterval(timer);\n      }\n    }, 1000);\n  }\n}\nGamePageComponent.ɵfac = function GamePageComponent_Factory(t) {\n  return new (t || GamePageComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.ContractService));\n};\nGamePageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: GamePageComponent,\n  selectors: [[\"app-game-page\"]],\n  decls: 6,\n  vars: 2,\n  consts: [[1, \"everything-wrapper\"], [1, \"title\"], [\"class\", \"content-wrapper\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"content-wrapper\"], [1, \"board-timer\"], [\"class\", \"text-center text-orange\", 3, \"ngClass\", 4, \"ngIf\"], [1, \"section-wrapper\"], [\"class\", \"square-container underline\", 4, \"ngFor\", \"ngForOf\"], [1, \"timmer-wrapper\"], [1, \"display-time\"], [1, \"detials-wrapper\"], [1, \"detials-sub-wrapper\"], [1, \"text-center\", \"text-orange\", 3, \"ngClass\"], [1, \"square-container\", \"underline\"], [1, \"game-square\", \"rounded-lg\", \"border\", \"bg-teal-lightest\", \"shadow-md\", 3, \"ngClass\", \"click\"], [1, \"text-grey-darker\"]],\n  template: function GamePageComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n      i0.ɵɵtext(3, \"Game Room\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(4, GamePageComponent_div_4_Template, 24, 7, \"div\", 2);\n      i0.ɵɵtemplate(5, GamePageComponent_div_5_Template, 2, 0, \"div\", 3);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.isGameRunning);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.isValidGame);\n    }\n  },\n  dependencies: [i3.NgClass, i3.NgForOf, i3.NgIf],\n  styles: [\".section-wrapper[_ngcontent-%COMP%] {\\n  width: 400px;\\n  display: flex;\\n  justify-content: space-evenly;\\n  align-content: center;\\n  align-items: center;\\n  flex-wrap: wrap;\\n}\\n\\n.everything-wrapper[_ngcontent-%COMP%] {\\n  height: 100vh;\\n  flex-direction: column;\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-evenly;\\n}\\n\\n.title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n  font-size: 35px;\\n  text-decoration: underline;\\n}\\n\\n.square-container[_ngcontent-%COMP%] {\\n  flex: 0 0 32%;\\n  font-weight: 700;\\n  height: 120px;\\n}\\n\\n.game-square[_ngcontent-%COMP%] {\\n  height: 96%;\\n  text-align: center;\\n  line-height: 0.85;\\n  cursor: pointer;\\n  border-radius: 8px;\\n  border-width: 1px;\\n  background-color: rgb(147, 197, 253);\\n  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);\\n}\\n\\np[_ngcontent-%COMP%] {\\n  display: inline;\\n  margin: 0px;\\n  font-size: 9rem;\\n  overflow: hidden;\\n}\\n\\n.noClick[_ngcontent-%COMP%] {\\n  pointer-events: none;\\n}\\n\\n.timmer-wrapper[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  justify-content: center;\\n}\\n.timmer-wrapper[_ngcontent-%COMP%]   .display-time[_ngcontent-%COMP%] {\\n  color: red;\\n  font-size: 24px;\\n}\\n\\n.content-wrapper[_ngcontent-%COMP%] {\\n  width: 100%;\\n  display: flex;\\n}\\n\\n.board-timer[_ngcontent-%COMP%] {\\n  flex: 1;\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n}\\n\\n.detials-wrapper[_ngcontent-%COMP%] {\\n  flex: 1;\\n  display: flex;\\n  flex-direction: column;\\n}\\n.detials-wrapper[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\\n  text-align: center;\\n  font-size: 25px;\\n  text-decoration: underline;\\n}\\n\\n.detials-sub-wrapper[_ngcontent-%COMP%] {\\n  font-size: 19px;\\n}\\n.detials-sub-wrapper[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] {\\n  margin-bottom: 10px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9nYW1lLXBhZ2UvZ2FtZS1wYWdlLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsWUFBQTtFQUNBLGFBQUE7RUFDQSw2QkFBQTtFQUNBLHFCQUFBO0VBQ0EsbUJBQUE7RUFDQSxlQUFBO0FBQ0Y7O0FBQ0E7RUFDRSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSw2QkFBQTtBQUVGOztBQUVFO0VBQ0UsZUFBQTtFQUNBLDBCQUFBO0FBQ0o7O0FBR0E7RUFDRSxhQUFBO0VBQ0EsZ0JBQUE7RUFDQSxhQUFBO0FBQUY7O0FBR0E7RUFDRSxXQUFBO0VBQ0Esa0JBQUE7RUFDQSxpQkFBQTtFQUNBLGVBQUE7RUFDQSxrQkFBQTtFQUNBLGlCQUFBO0VBQ0Esb0NBQUE7RUFDQSxnRkFBQTtBQUFGOztBQUdBO0VBQ0UsZUFBQTtFQUNBLFdBQUE7RUFDQSxlQUFBO0VBQ0EsZ0JBQUE7QUFBRjs7QUFHQTtFQUNFLG9CQUFBO0FBQUY7O0FBR0E7RUFDRSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0FBQUY7QUFDRTtFQUNFLFVBQUE7RUFDQSxlQUFBO0FBQ0o7O0FBR0E7RUFDRSxXQUFBO0VBQ0EsYUFBQTtBQUFGOztBQUdBO0VBQ0UsT0FBQTtFQUNBLGFBQUE7RUFDQSxzQkFBQTtFQUNBLG1CQUFBO0FBQUY7O0FBRUE7RUFDRSxPQUFBO0VBQ0EsYUFBQTtFQUNBLHNCQUFBO0FBQ0Y7QUFBRTtFQUNFLGtCQUFBO0VBQ0EsZUFBQTtFQUNBLDBCQUFBO0FBRUo7O0FBQ0E7RUFDRSxlQUFBO0FBRUY7QUFERTtFQUNFLG1CQUFBO0FBR0oiLCJzb3VyY2VzQ29udGVudCI6WyIuc2VjdGlvbi13cmFwcGVyIHtcbiAgd2lkdGg6IDQwMHB4O1xuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWV2ZW5seTtcbiAgYWxpZ24tY29udGVudDogY2VudGVyO1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBmbGV4LXdyYXA6IHdyYXA7XG59XG4uZXZlcnl0aGluZy13cmFwcGVyIHtcbiAgaGVpZ2h0OiAxMDB2aDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1ldmVubHk7XG59XG5cbi50aXRsZSB7XG4gIGgyIHtcbiAgICBmb250LXNpemU6IDM1cHg7XG4gICAgdGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmU7XG4gIH1cbn1cblxuLnNxdWFyZS1jb250YWluZXIge1xuICBmbGV4OiAwIDAgMzIlO1xuICBmb250LXdlaWdodDogNzAwO1xuICBoZWlnaHQ6IDEyMHB4O1xufVxuXG4uZ2FtZS1zcXVhcmUge1xuICBoZWlnaHQ6IDk2JTtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBsaW5lLWhlaWdodDogMC44NTtcbiAgY3Vyc29yOiBwb2ludGVyO1xuICBib3JkZXItcmFkaXVzOiA4cHg7XG4gIGJvcmRlci13aWR0aDogMXB4O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMTQ3IDE5NyAyNTMpO1xuICBib3gtc2hhZG93OiAwIDRweCA2cHggLTFweCByZ2IoMCAwIDAgLyAwLjEpLCAwIDJweCA0cHggLTJweCByZ2IoMCAwIDAgLyAwLjEpO1xufVxuXG5wIHtcbiAgZGlzcGxheTogaW5saW5lO1xuICBtYXJnaW46IDBweDtcbiAgZm9udC1zaXplOiA5cmVtO1xuICBvdmVyZmxvdzogaGlkZGVuO1xufVxuXG4ubm9DbGljayB7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xufVxuXG4udGltbWVyLXdyYXBwZXIge1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgLmRpc3BsYXktdGltZSB7XG4gICAgY29sb3I6IHJlZDtcbiAgICBmb250LXNpemU6IDI0cHg7XG4gIH1cbn1cblxuLmNvbnRlbnQtd3JhcHBlciB7XG4gIHdpZHRoOiAxMDAlO1xuICBkaXNwbGF5OiBmbGV4O1xufVxuXG4uYm9hcmQtdGltZXIge1xuICBmbGV4OiAxO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xufVxuLmRldGlhbHMtd3JhcHBlciB7XG4gIGZsZXg6IDE7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIGgzIHtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgZm9udC1zaXplOiAyNXB4O1xuICAgIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lO1xuICB9XG59XG4uZGV0aWFscy1zdWItd3JhcHBlciB7XG4gIGZvbnQtc2l6ZTogMTlweDtcbiAgbGkge1xuICAgIG1hcmdpbi1ib3R0b206IDEwcHg7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","GamePageComponent","constructor","route","contractService","isGameRunning","gameId","console","log","snapshot","params","checkGameState","ngOnInit","gameStartedObject$","subscribe","data","room","newGame","timer","board","createBoard","i","length","push","id","state","squareClicked","index","move","loader$","next","e","alert","minute","seconds","textSec","statSec","prefix","setInterval","display","Math","floor","clearInterval","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["/Users/pushpendra.khandelwal/Desktop/web3_training/tic-tac-toe/ui/src/app/components/game-page/game-page.component.html","/Users/pushpendra.khandelwal/Desktop/web3_training/tic-tac-toe/ui/src/app/components/game-page/game-page.component.ts"],"sourcesContent":["<div class=\"everything-wrapper\">\n  <div class=\"title\">\n    <h2>Game Room</h2>\n  </div>\n\n  <div class=\"content-wrapper\" *ngIf=\"isGameRunning\">\n    <div class=\"board-timer\">\n      <div>\n        <h1\n          class=\"text-center text-orange\"\n          *ngIf=\"isGameRunning\"\n          [ngClass]=\"{ 'text-teal': activePlayer == 'O' }\"\n        >\n          {{ activePlayer }}'S TURN\n        </h1>\n        <div class=\"section-wrapper\">\n          <div class=\"square-container underline\" *ngFor=\"let square of board\">\n            <div\n              class=\"game-square rounded-lg border bg-teal-lightest shadow-md\"\n              (click)=\"squareClicked(square)\"\n              [ngClass]=\"{ noClick: winner }\"\n            >\n              <p class=\"text-grey-darker\">{{ square.state }}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"timmer-wrapper\">\n        <h2>Timer</h2>\n        <div class=\"display-time\">\n          {{ display }}\n        </div>\n      </div>\n    </div>\n\n    <div class=\"detials-wrapper\">\n      <h3>Details</h3>\n      <div class=\"detials-sub-wrapper\">\n        <ul>\n          <li>WinnerName: {{ winnerName }}</li>\n          <li>WinnerName: {{ winnerName }}</li>\n          <li>WinnerName: {{ winnerName }}</li>\n          <li>WinnerName: {{ winnerName }}</li>\n        </ul>\n      </div>\n    </div>\n  </div>\n  <div *ngIf=\"!isValidGame\">\n    \"Game is not running\"\n  </div>\n</div>\n","import { AfterViewInit, Component, OnInit } from \"@angular/core\";\nimport { ActivatedRoute, Router } from \"@angular/router\";\nimport { ContractService } from \"src/app/services/contract.service\";\n\n@Component({\n  selector: \"app-game-page\",\n  templateUrl: \"./game-page.component.html\",\n  styleUrls: [\"./game-page.component.scss\"],\n})\nexport class GamePageComponent implements OnInit {\n  board: any;\n  isGameRunning: boolean = false;\n  winner: boolean = false;\n  activePlayer: string = \"X\";\n  isGameOver: boolean = false;\n  turnCount = 0;\n  display: any;\n  winnerName: any;\n  isValidGame: boolean = false;\n\n  room: any;\n\n  gameId: number = -1;\n\n  constructor(private route: ActivatedRoute, private contractService: ContractService) {\n    console.log(\"constructor\");\n    \n    this.gameId = route.snapshot.params['id'];\n    this.checkGameState();\n\n  }\n\n  ngOnInit(): void {\n    this.contractService.gameStartedObject$.subscribe((data) => {\n      console.log(\"gameStartedObject\",data);\n      this.room = data;\n    });\n    // this.contractService.moveIndex$.subscribe((data) => {\n    //   console.log(\"gameStartedObject\",data);\n    //   this.room = data;\n    // });\n    this.newGame();\n    this.timer(2);\n  }\n\n\n  checkGameState = async () => {\n    this.isGameRunning = await this.contractService.isGameRunning(this.gameId);\n  }\n\n  newGame() {\n    this.board = this.createBoard();\n  }\n\n  createBoard() {\n    let board = [];\n    console.log(this.room, \"room\");\n    \n    for (let i = 0; i < this.room.board.length; i++) {\n      board.push({ id: i, state: this.room[i] == 1 ? \"X\" : \"0\"});\n    }\n    return board;\n  }\n\n  async squareClicked(index: any) {\n    if(this.isGameRunning) {\n      try {\n        await this.contractService.move(this.gameId, index);\n        this.contractService.loader$.next(false);\n      } catch(e) {\n        alert(\"Error while playing move\");\n      }\n    } \n  }\n\n  // changePlayer(square: any) {\n  //   if (this.isGameRunning && square.state === null) {\n  //     this.contractService.move(this.gameId, square.id).then((resp) => {\n  //       this.contractService.loader$.next(false);\n  //       // this.winnerName = resp;\n  //       this.changePlayerTurn(square);\n  //     });\n  //     square.state = this.activePlayer;\n  //   }\n  // }\n\n  // private changePlayerTurn(squareClicked: any) {\n  //   this.updateBoard(squareClicked);\n  //   if (!this.isGameOver)\n  //     this.activePlayer = this.activePlayer === \"X\" ? \"O\" : \"X\";\n  //   this.turnCount++;\n  //   this.isGameOver = this.isGameOver ? true : false;\n  // }\n\n  // updateBoard(squareClicked: any) {\n  //   this.board[squareClicked.id].state = squareClicked.state;\n  //   if (this.isWinner) {\n  //     this.winner = true;\n  //     this.isGameRunning = false;\n  //     this.isGameOver = true;\n  //   }\n  // }\n\n  // get isWinner(): boolean {\n  //   return this.checkDiag() ||\n  //     this.checkRows(this.board, \"row\") ||\n  //     this.checkRows(this.board, \"col\")\n  //     ? true\n  //     : false;\n  // }\n\n  // checkDiag() {\n  //   const timesRun = 2,\n  //     midSquare = this.board[4].state;\n\n  //   for (let i = 0; i <= timesRun; i += 2) {\n  //     let upperCorner = this.board[i].state,\n  //       lowerCorner = this.board[8 - i].state;\n\n  //     if (midSquare && upperCorner && lowerCorner) {\n  //       if (midSquare === upperCorner && upperCorner === lowerCorner)\n  //         return true;\n  //     }\n  //   }\n\n  //   return false;\n  // }\n\n  // checkRows(board: any, mode: any): boolean {\n  //   const ROW = mode === \"row\" ? true : false,\n  //     DIST = ROW ? 1 : 3,\n  //     INC = ROW ? 3 : 1,\n  //     NUMTIMES = ROW ? 7 : 3;\n\n  //   for (let i = 0; i < NUMTIMES; i += INC) {\n  //     let firstSquare = board[i].state,\n  //       secondSquare = board[i + DIST].state,\n  //       thirdSquare = board[i + DIST * 2].state;\n\n  //     if (firstSquare && secondSquare && thirdSquare) {\n  //       if (firstSquare === secondSquare && secondSquare === thirdSquare)\n  //         return true;\n  //     }\n  //   }\n  //   return false;\n  // }\n\n  timer(minute: number) {\n    // let minute = 1;\n    let seconds: number = minute * 60;\n    let textSec: any = \"0\";\n    let statSec: number = 60;\n\n    const prefix = minute < 10 ? \"0\" : \"\";\n\n    const timer = setInterval(() => {\n      seconds--;\n      if (statSec != 0) statSec--;\n      else statSec = 59;\n\n      if (statSec < 10) {\n        textSec = \"0\" + statSec;\n      } else textSec = statSec;\n\n      this.display = `${prefix}${Math.floor(seconds / 60)}:${textSec}`;\n\n      if (seconds == 0) {\n        this.display = \"Time Up\";\n        clearInterval(timer);\n      }\n    }, 1000);\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}